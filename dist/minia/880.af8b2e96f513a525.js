"use strict";(self.webpackChunkminia=self.webpackChunkminia||[]).push([[880],{5880:(k,p,a)=>{a.r(p),a.d(p,{GroupsModule:()=>y});var f=a(177),d=a(8498),n=a(9417),m=a(3887),c=a(3682),v=a(3165),e=a(4438),g=a(5441),F=a(5794),h=a(8548);let C=(()=>{class s{constructor(o,t,r,i){this.groupsService=o,this.cdr=t,this.formBuilder=r,this.toastr=i,this.allSubCounties=[],this.counties=[],this.sub_counties=[],this.wards=[],this.groups=[],this.userId=sessionStorage.getItem("userId")}ngOnInit(){this.counties=v.v,this.breadCrumbItems=[{label:"Groups"},{label:"Add Group",active:!0}],this.registerForm=this.formBuilder.group({groupName:["",n.k0.required],description:["",n.k0.required]}),this.searchForm=this.formBuilder.group({countyId:["",n.k0.required],subCountyId:["",n.k0.required],wardId:["",n.k0.required]})}onSubmit(){let o={groupName:this.registerForm.get("groupName")?.value,description:this.registerForm.get("description")?.value,wardId:this.wardId,userId:this.userId};this.groupsService.addGroup(o).subscribe(t=>{201==t.statusCode&&(this.toastr.success("Group Added","Success"),this.registerForm.reset(),this.searchForm.reset())})}filterGroups(o){this.groupsService.getGroupsByLocation(o).subscribe(t=>{200==t.statusCode&&(this.groups=t.message,this.cdr.markForCheck())})}getWards(o){let t=this.searchForm.get("subCountyId")?.value;this.sub_counties.filter(i=>t.includes(i.subCountyId)).forEach(i=>{this.wards=this.wards.concat(i.wards)})}subCounties(o){let t=this.searchForm.get("countyId")?.value;this.counties.filter(i=>t.includes(i.county_id)).forEach(i=>{this.sub_counties=this.sub_counties.concat(i.sub_counties)})}filterWards(o){let t=this.searchForm.get("subCountyId")?.value;this.sub_counties.filter(i=>t.includes(i.subCountyId)).forEach(i=>{this.wards=this.wards.concat(i.wards)})}getWardId(o){this.wardId=o[0].wardId}static#e=this.\u0275fac=function(t){return new(t||s)(e.rXU(g.U),e.rXU(e.gRc),e.rXU(n.ok),e.rXU(F.tw))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["app-add-group"]],standalone:!0,features:[e.aNF],decls:36,vars:12,consts:[["title","Groups",3,"breadcrumbItems"],[1,"card"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["bindLabel","name","bindValue","county_id","placeholder","Select County","formControlName","countyId",3,"items","multiple","virtualScroll","change"],["bindLabel","name","bindValue","subCountyId","placeholder","Select Sub County","formControlName","subCountyId",3,"items","multiple","virtualScroll","change"],["bindLabel","name","bindValue","wardId","placeholder","Select Ward","formControlName","wardId",3,"items","multiple","virtualScroll","change"],[1,"form-group","position-relative"],["type","text","placeholder","Name","formControlName","groupName",1,"form-control"],[1,"col-12"],["placeholder","Description","formControlName","description","cols","3","rows","5",1,"form-control"],[1,"col-sm-12"],["type","button","type","submit",1,"btn","btn-primary","mr-2",2,"margin-top","25px",3,"click"]],template:function(t,r){1&t&&(e.nrm(0,"app-pagetitle",0),e.j41(1,"div")(2,"div",1)(3,"div",2)(4,"form",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label"),e.EFF(9,"County"),e.k0s(),e.j41(10,"ng-select",7),e.bIt("change",function(u){return r.subCounties(u)}),e.k0s()()(),e.j41(11,"div",5)(12,"div",6)(13,"label"),e.EFF(14,"Sub-county"),e.k0s(),e.j41(15,"ng-select",8),e.bIt("change",function(u){return r.getWards(u)}),e.k0s()()(),e.j41(16,"div",5)(17,"div",6)(18,"label"),e.EFF(19,"Ward"),e.k0s(),e.j41(20,"ng-select",9),e.bIt("change",function(u){return r.getWardId(u)}),e.k0s()()()()(),e.j41(21,"form",3)(22,"div",4)(23,"div",5)(24,"label"),e.EFF(25,"Name"),e.k0s(),e.j41(26,"fieldset",10),e.nrm(27,"input",11),e.k0s()(),e.j41(28,"div",12)(29,"label"),e.EFF(30,"Description"),e.k0s(),e.j41(31,"fieldset",10),e.nrm(32,"textarea",13),e.k0s()(),e.j41(33,"div",14)(34,"button",15),e.bIt("click",function(){return r.onSubmit()}),e.EFF(35,"Save"),e.k0s()()()()()()()),2&t&&(e.Y8G("breadcrumbItems",r.breadCrumbItems),e.R7$(4),e.Y8G("formGroup",r.searchForm),e.R7$(6),e.Y8G("items",r.counties)("multiple",!0)("virtualScroll",!0),e.R7$(5),e.Y8G("items",r.sub_counties)("multiple",!0)("virtualScroll",!0),e.R7$(5),e.Y8G("items",r.wards)("multiple",!0)("virtualScroll",!0),e.R7$(1),e.Y8G("formGroup",r.registerForm))},dependencies:[m.G,h.T,n.X1,n.qT,n.me,n.BC,n.cb,n.j4,n.JD,c.MQ,c.vr]})}return s})();var l=a(3380);function G(s,b){if(1&s&&e.EFF(0),2&s){const o=b.row;e.Lme(" ",o.first_name," ",o.last_name," ")}}function I(s,b){if(1&s){const o=e.RV6();e.qSk(),e.j41(0,"svg",23),e.bIt("click",function(){const i=e.eBV(o).row,u=e.XpG();return e.Njj(u.view(i))}),e.j41(1,"g",24),e.nrm(2,"circle",25)(3,"path",26),e.k0s()()}}const _=[{path:"add-group",component:C},{path:"group/:id",component:(()=>{class s{constructor(o,t,r,i){this.route=o,this.cdr=t,this.router=r,this.groupsService=i,this.group={},this.rows=[],this.ColumnMode=l.oZ,this.dataParams={page_num:"",page_size:""}}ngOnInit(){this.dataParams.page_num=0,this.dataParams.page_size=10,this.route.params.subscribe(o=>{this.groupId=+o.id}),this.getGroupDetails(this.groupId)}getGroupDetails(o){this.groupsService.getGroupDetails(o).subscribe(t=>{200==t.statusCode&&(this.group=t.message,this.getGroupMembers(t.message?.group_id),this.updateBreadcrumbs(),this.cdr.markForCheck())})}view(o){this.router.navigate(["/clients/details/",o.member_id])}getGroupMembers(o){this.groupsService.getGroupMembers(o).subscribe(t=>{200==t.statusCode&&(this.rows=t.message)})}setPage(o){}viewUserDetails(o){this.router.navigate(["/clients/details/",o.member_id])}updateBreadcrumbs(){this.breadCrumbItems=[{label:"Reports"},{label:"Group",active:!0}]}static#e=this.\u0275fac=function(t){return new(t||s)(e.rXU(d.nX),e.rXU(e.gRc),e.rXU(d.Ix),e.rXU(g.U))};static#t=this.\u0275cmp=e.VBU({type:s,selectors:[["app-group"]],standalone:!0,features:[e.aNF],decls:51,vars:18,consts:[[3,"title","breadcrumbItems"],[1,"w-100"],[1,"card","p-2","d-flex","flex-row","justify-content-between","w-100"],[1,"w-50","d-flex","flex-column","justify-content-center"],[2,"color","#fbab3d"],[1,"d-flex","flex-row","gap-2"],[1,"card-body","w-50"],[1,"d-flex"],[1,"d-flex","flex-column","gap-1"],[1,"font-size-16"],[1,"text-muted","font-size-13"],[1,"card",2,"min-height","100px","padding","20px"],[2,"background-color","white","padding","10px","width","100%"],[1,"bootstrap","core-bootstrap",3,"externalPaging","count","offset","limit","rows","rowHeight","columnMode","headerHeight","footerHeight","page"],["table",""],["name","Name"],["ngx-datatable-cell-template",""],["name","Mobile","prop","msisdn"],["name","ID Number","prop","id_number"],["name","County","prop","county_title"],["name","Sub County","prop","sub_county_title"],["name","Ward","prop","ward_name"],["name","More Details","prop","more"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24",3,"click"],["fill","none","stroke","currentColor","stroke-width","2"],["cx","12","cy","12","r","3"],["d","M20.188 10.934c.388.472.582.707.582 1.066c0 .359-.194.594-.582 1.066C18.768 14.79 15.636 18 12 18c-3.636 0-6.768-3.21-8.188-4.934c-.388-.472-.582-.707-.582-1.066c0-.359.194-.594.582-1.066C5.232 9.21 8.364 6 12 6c3.636 0 6.768 3.21 8.188 4.934Z"]],template:function(t,r){1&t&&(e.nrm(0,"app-pagetitle",0),e.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),e.EFF(5,"Group details"),e.k0s(),e.j41(6,"div",5)(7,"p"),e.EFF(8,"Group Name:"),e.k0s(),e.j41(9,"p"),e.EFF(10),e.k0s()(),e.j41(11,"div",5)(12,"p"),e.EFF(13,"Group Code:"),e.k0s(),e.j41(14,"p"),e.EFF(15),e.k0s()(),e.j41(16,"div",5)(17,"p"),e.EFF(18,"Date created:"),e.k0s(),e.j41(19,"p"),e.EFF(20),e.k0s()()(),e.j41(21,"div",6)(22,"p",4),e.EFF(23,"Group Admin"),e.k0s(),e.j41(24,"div",7)(25,"div",8)(26,"h5",9),e.EFF(27),e.k0s(),e.j41(28,"p",10),e.EFF(29),e.k0s(),e.j41(30,"p",10),e.EFF(31),e.k0s()()()()(),e.j41(32,"p"),e.EFF(33,"Group Description"),e.k0s(),e.j41(34,"div",11)(35,"p"),e.EFF(36),e.k0s()()(),e.j41(37,"p"),e.EFF(38,"Group members"),e.k0s(),e.j41(39,"div",12)(40,"ngx-datatable",13,14),e.bIt("page",function(u){return r.setPage(u)}),e.j41(42,"ngx-datatable-column",15),e.DNE(43,G,1,2,"ng-template",16),e.k0s(),e.nrm(44,"ngx-datatable-column",17)(45,"ngx-datatable-column",18)(46,"ngx-datatable-column",19)(47,"ngx-datatable-column",20)(48,"ngx-datatable-column",21),e.j41(49,"ngx-datatable-column",22),e.DNE(50,I,4,0,"ng-template",16),e.k0s()()()),2&t&&(e.Y8G("title",r.group.group_name)("breadcrumbItems",r.breadCrumbItems),e.R7$(10),e.JRh(r.group.group_name),e.R7$(5),e.JRh(r.group.group_code),e.R7$(5),e.JRh(r.group.created_at),e.R7$(7),e.SpI("Name: ",r.group.group_admin.name,""),e.R7$(2),e.SpI(" Phone no: ",r.group.group_admin.msisdn," "),e.R7$(2),e.SpI(" Email: ",r.group.group_admin.email," "),e.R7$(5),e.JRh(null==r.group?null:r.group.description),e.R7$(4),e.Y8G("externalPaging",!1)("count",r.rows.length)("offset",r.dataParams.page_num)("limit",r.dataParams.page_size)("rows",r.rows)("rowHeight",50)("columnMode",r.ColumnMode.force)("headerHeight",50)("footerHeight",50))},dependencies:[m.G,h.T,l.Kj,l.ge,l.ed,l.QI]})}return s})()}];let w=(()=>{class s{static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275mod=e.$C({type:s});static#r=this.\u0275inj=e.G2t({imports:[d.iI.forChild(_),d.iI]})}return s})(),y=(()=>{class s{static#e=this.\u0275fac=function(t){return new(t||s)};static#t=this.\u0275mod=e.$C({type:s});static#r=this.\u0275inj=e.G2t({imports:[f.MD,w]})}return s})()}}]);